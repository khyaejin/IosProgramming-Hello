# name: iOS starter workflow

# on:
#   push:
#     branches: [ "develop", "main" ]
#   pull_request:
#     branches: [ "develop", "main" ]

# jobs:
#   build:
#     name: Build and Test using default scheme
#     runs-on: macos-14
#     env:
#       DEVELOPER_DIR: /Applications/Xcode_15.3.app/Contents/Developer

#     steps:
#       - name: Checkout
#         uses: actions/checkout@v4

#       - name: Build
#         env:
#           scheme: "IosProject-hello"         
#           platform: "iOS Simulator"
#         run: |
#           device=`xcrun xctrace list devices 2>&1 | grep -oE 'iPhone.*?[^\(]+' | head -1 | awk '{$1=$1;print}' | sed -e "s/ Simulator$//"`
#           if [ "`ls -A | grep -i \\.xcworkspace\$`" ]; then filetype_parameter="workspace" && file_to_build="`ls -A | grep -i \\.xcworkspace\$`"; else filetype_parameter="project" && file_to_build="`ls -A | grep -i \\.xcodeproj\$`"; fi
#           file_to_build=`echo $file_to_build | awk '{$1=$1;print}'`
#           xcodebuild build-for-testing -scheme "$scheme" -"$filetype_parameter" "$file_to_build" -destination "platform=$platform,name=$device"

#       - name: Test
#         env:
#           scheme: "IosProject-hello"
#           platform: "iOS Simulator"
#         run: |
#           device=`xcrun xctrace list devices 2>&1 | grep -oE 'iPhone.*?[^\(]+' | head -1 | awk '{$1=$1;print}' | sed -e "s/ Simulator$//"`
#           if [ "`ls -A | grep -i \\.xcworkspace\$`" ]; then filetype_parameter="workspace" && file_to_build="`ls -A | grep -i \\.xcworkspace\$`"; else filetype_parameter="project" && file_to_build="`ls -A | grep -i \\.xcodeproj\$`"; fi
#           file_to_build=`echo $file_to_build | awk '{$1=$1;print}'`
#           xcodebuild test-without-building -scheme "$scheme" -"$filetype_parameter" "$file_to_build" -destination "platform=$platform,name=$device"
